FROM ansibleplaybookbundle/apb-base
# MAINTAINER {{ $MAINTAINER }}

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wLjAKbmFtZTogZXRoZXJwYWQtYXBiCmRlc2NyaXB0aW9uOiBOb3RlIHRha2lu\
ZyB3ZWIgYXBwbGljYXRpb24KYmluZGFibGU6IFRydWUKYXN5bmM6IG9wdGlvbmFsCm1ldGFkYXRh\
OiAKICBkb2N1bWVudGF0aW9uVXJsOiBodHRwczovL2dpdGh1Yi5jb20vZXRoZXIvZXRoZXJwYWQt\
bGl0ZS93aWtpCiAgaW1hZ2VVcmw6IGh0dHBzOi8vdHJhbnNsYXRld2lraS5uZXQvaW1hZ2VzL3Ro\
dW1iLzYvNmYvRXRoZXJwYWRfbGl0ZS5zdmcvMjAwcHgtRXRoZXJwYWRfbGl0ZS5zdmcucG5nCiAg\
ZGVwZW5kZW5jaWVzOiBbJ2RvY2tlci5pby9tYXJpYWRiOmxhdGVzdCcsICdkb2NrZXIuaW8vdHZl\
bG9jaXR5L2V0aGVycGFkLWxpdGU6bGF0ZXN0J10KICBkaXNwbGF5TmFtZTogRXRoZXJwYWQgKEFQ\
QikKICBsb25nRGVzY3JpcHRpb246IEFuIGFwYiB0aGF0IGRlcGxveXMgRXRoZXJwYWQgTGl0ZQog\
IHByb3ZpZGVyRGlzcGxheU5hbWU6ICJSZWQgSGF0LCBJbmMuIgpwbGFuczoKICAtIG5hbWU6IGRl\
ZmF1bHQKICAgIGRlc2NyaXB0aW9uOiBBIHNpbmdsZSBldGhlcnBhZCBhcHBsaWNhdGlvbiB3aXRo\
IG5vIERCCiAgICBmcmVlOiB0cnVlCiAgICBtZXRhZGF0YToKICAgICAgZGlzcGxheU5hbWU6IERl\
ZmF1bHQKICAgICAgbG9uZ0Rlc2NyaXB0aW9uOiBUaGlzIHBsYW4gcHJvdmlkZXMgYSBzaW5nbGUg\
RXRoZXJwYWQgYXBwbGljYXRpb24gd2l0aCBubyBkYXRhYmFzZQogICAgICBjb3N0OiAkMC4wMAog\
ICAgcGFyYW1ldGVyczoKICAgICAgLSBuYW1lOiBtYXJpYWRiX25hbWUKICAgICAgICByZXF1aXJl\
ZDogdHJ1ZQogICAgICAgIGRlZmF1bHQ6IGV0aGVycGFkCiAgICAgICAgdHlwZTogc3RyaW5nCiAg\
ICAgICAgdGl0bGU6IE1hcmlhREIgRGF0YWJhc2UgTmFtZQogICAgICAtIG5hbWU6IG1hcmlhZGJf\
dXNlcgogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgZGVmYXVsdDogZXRoZXJwYWQKICAg\
ICAgICB0aXRsZTogTWFyaWFEQiBVc2VyCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgbWF4\
bGVuZ3RoOiA2MwogICAgICAtIG5hbWU6IG1hcmlhZGJfcGFzc3dvcmQKICAgICAgICBkZWZhdWx0\
OiBhZG1pbgogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIGRlc2NyaXB0aW9uOiBBIHJhbmRv\
bSBhbHBoYW51bWVyaWMgc3RyaW5nIGlmIGxlZnQgYmxhbmsKICAgICAgICB0aXRsZTogTWFyaWFE\
QiBQYXNzd29yZAogICAgICAtIG5hbWU6IG1hcmlhZGJfcm9vdF9wYXNzd29yZAogICAgICAgIGRl\
ZmF1bHQ6IGFkbWluCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgZGVzY3JpcHRpb246IHJv\
b3QgcGFzc3dvcmQgZm9yIG1hcmlhZGIKICAgICAgICB0aXRsZTogUm9vdCBQYXNzd29yZAo="

ADD playbooks /opt/apb/actions
ADD roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}

USER apb
